<!DOCTYPE html>
<html>
<head>
    <title>Basic Query Cyclop</title>
</head>
<body>
    <h1>Hello World</h1>
    <script src="../../dist/cyclop.js"></script>
    <script type="text/javascript">

      var client = new Cyclop.ConnectionGraphql({
        url: "http://localhost:3000/graphql",
        headers: ""
      });

      var client2 = new Cyclop.ConnectionGraphql({
        url: "http://localhost:3005/graphqlUser",
        headers: ""
      });

      var queryDoc = `query {
        getProducts {
          _id
          name
          price
          category
        }
        getProductByPrice(price: 2000) {
          _id
          name
          price
          category
        }
      }`

      var queryPreprox = `query {
        products {
          _id
          name
          price
        }
        product(product_id: $product_id) {
          _id
          name
          price
        }
        order(order_name: $order_name) {
          _id
          name
          price
          amount
          category
          status
        }
      }`

      var queryPrice = `query {
        getProductByPrice(price: $price) {
          _id
          name
          price
          category
        }
        getProductByPrice(id: $id, price: $price) {
          _id
          name
          price
          category
        }
      }`

      var mutateDoc = `
        mutation {
          addProduct(
            name: $name,
            price: $price,
            category: $category
          ) {
            _id
            name
            price
            category
          }
      }`

      var variables = [{
        price: 2000
      },
      {
        id: "2222",
        price: 1000
      }]

      graphFetch(client, queryDoc);
      graphFetchbyVariables(client, queryPrice, variables);

      function graphFetch(client, doc) {
        var promise = new Promise(function(resolve, reject) {
          client.query(doc).then(function(response){
            var {data, errors} = response;
            if (data) {
              resolve(data);
            }
            else {
              reject(Error(errors));
            }
          });
        });
        promise.then(function(response){
          console.log("client : ", client);
          console.log(response);
          return response;
        });
      }

      function graphFetchbyVariables(client, doc, variables) {
        var promise = new Promise(function(resolve, reject) {
          client.query(doc, variables).then(function(response){
            var {data, errors} = response;
            if (data) {
              resolve(data);
            }
            else {
              reject(Error(errors));
            }
          });
        });
        promise.then(function(response){
          console.log("client : ", client);
          console.log(response);
          return response;
        });
      }

      // console.log(client.query(queryDoc));
      // console.log(client2.query(queryDoc));

      // client.query( queryDoc ).then()
      // client.mutate( mutateDoc, variables ).then()


    </script>
</body>
</html>